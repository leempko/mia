<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p22" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_22{left:245px;bottom:1041px;letter-spacing:0.11px;}
#t2_22{left:488px;bottom:1041px;letter-spacing:0.14px;word-spacing:1.26px;}
#t3_22{left:593px;bottom:1041px;letter-spacing:0.03px;word-spacing:1.51px;}
#t4_22{left:245px;bottom:999px;letter-spacing:0.06px;word-spacing:2.05px;}
#t5_22{left:245px;bottom:980px;letter-spacing:-0.26px;word-spacing:1.97px;}
#t6_22{left:245px;bottom:923px;letter-spacing:-0.04px;}
#t7_22{left:302px;bottom:923px;letter-spacing:-0.12px;word-spacing:2.89px;}
#t8_22{left:245px;bottom:891px;letter-spacing:0.1px;word-spacing:-0.19px;}
#t9_22{left:672px;bottom:891px;letter-spacing:0.09px;}
#ta_22{left:691px;bottom:891px;letter-spacing:0.1px;word-spacing:1.14px;}
#tb_22{left:245px;bottom:873px;letter-spacing:0.07px;word-spacing:2.86px;}
#tc_22{left:245px;bottom:855px;letter-spacing:0.08px;word-spacing:0.73px;}
#td_22{left:245px;bottom:836px;letter-spacing:0.11px;word-spacing:1.18px;}
#te_22{left:245px;bottom:818px;letter-spacing:0.08px;word-spacing:1.15px;}
#tf_22{left:245px;bottom:800px;letter-spacing:0.05px;word-spacing:1.42px;}
#tg_22{left:245px;bottom:782px;letter-spacing:0.1px;word-spacing:2.45px;}
#th_22{left:245px;bottom:763px;letter-spacing:0.09px;word-spacing:1.46px;}
#ti_22{left:245px;bottom:745px;letter-spacing:0.09px;}
#tj_22{left:268px;bottom:726px;letter-spacing:0.11px;}
#tk_22{left:295px;bottom:726px;}
#tl_22{left:309px;bottom:726px;letter-spacing:4.39px;}
#tm_22{left:331px;bottom:726px;}
#tn_22{left:339px;bottom:726px;}
#to_22{left:346px;bottom:726px;letter-spacing:2.64px;}
#tp_22{left:389px;bottom:726px;}
#tq_22{left:400px;bottom:726px;}
#tr_22{left:406px;bottom:734px;}
#ts_22{left:420px;bottom:726px;letter-spacing:0.11px;word-spacing:0.75px;}
#tt_22{left:245px;bottom:708px;letter-spacing:0.07px;word-spacing:2.2px;}
#tu_22{left:433px;bottom:708px;letter-spacing:-0.15px;}
#tv_22{left:470px;bottom:708px;letter-spacing:0.1px;word-spacing:2.2px;}
#tw_22{left:683px;bottom:708px;}
#tx_22{left:702px;bottom:708px;letter-spacing:0.11px;word-spacing:2.06px;}
#ty_22{left:245px;bottom:689px;letter-spacing:0.12px;}
#tz_22{left:276px;bottom:689px;}
#t10_22{left:295px;bottom:689px;letter-spacing:0.11px;word-spacing:2.29px;}
#t11_22{left:430px;bottom:689px;letter-spacing:-0.02px;word-spacing:2.64px;}
#t12_22{left:580px;bottom:689px;}
#t13_22{left:595px;bottom:689px;letter-spacing:6.17px;}
#t14_22{left:619px;bottom:689px;}
#t15_22{left:626px;bottom:689px;}
#t16_22{left:633px;bottom:689px;letter-spacing:2.64px;}
#t17_22{left:674px;bottom:689px;}
#t18_22{left:685px;bottom:689px;}
#t19_22{left:691px;bottom:697px;}
#t1a_22{left:707px;bottom:689px;letter-spacing:0.1px;word-spacing:2.33px;}
#t1b_22{left:245px;bottom:671px;letter-spacing:0.09px;word-spacing:1.98px;}
#t1c_22{left:245px;bottom:653px;letter-spacing:0.09px;word-spacing:1.27px;}
#t1d_22{left:344px;bottom:653px;letter-spacing:0.11px;}
#t1e_22{left:398px;bottom:653px;letter-spacing:0.11px;word-spacing:1.45px;}
#t1f_22{left:422px;bottom:595px;}
#t1g_22{left:432px;bottom:595px;}
#t1h_22{left:438px;bottom:595px;}
#t1i_22{left:447px;bottom:595px;}
#t1j_22{left:454px;bottom:595px;}
#t1k_22{left:467px;bottom:595px;letter-spacing:4.39px;}
#t1l_22{left:493px;bottom:630px;}
#t1m_22{left:493px;bottom:604px;}
#t1n_22{left:493px;bottom:594px;}
#t1o_22{left:516px;bottom:619px;}
#t1p_22{left:523px;bottom:619px;}
#t1q_22{left:530px;bottom:619px;}
#t1r_22{left:536px;bottom:619px;}
#t1s_22{left:545px;bottom:619px;}
#t1t_22{left:552px;bottom:619px;}
#t1u_22{left:565px;bottom:619px;}
#t1v_22{left:541px;bottom:603px;}
#t1w_22{left:541px;bottom:597px;}
#t1x_22{left:541px;bottom:590px;}
#t1y_22{left:514px;bottom:572px;}
#t1z_22{left:521px;bottom:572px;}
#t20_22{left:532px;bottom:572px;}
#t21_22{left:538px;bottom:572px;}
#t22_22{left:547px;bottom:572px;}
#t23_22{left:554px;bottom:572px;}
#t24_22{left:567px;bottom:572px;}
#t25_22{left:580px;bottom:630px;}
#t26_22{left:580px;bottom:604px;}
#t27_22{left:580px;bottom:594px;}
#t28_22{left:739px;bottom:595px;letter-spacing:0.09px;}
#t29_22{left:245px;bottom:538px;letter-spacing:0.12px;word-spacing:1.59px;}
#t2a_22{left:245px;bottom:520px;letter-spacing:0.1px;word-spacing:2.4px;}
#t2b_22{left:464px;bottom:520px;letter-spacing:0.11px;}
#t2c_22{left:502px;bottom:520px;}
#t2d_22{left:509px;bottom:519px;}
#t2e_22{left:516px;bottom:520px;}
#t2f_22{left:522px;bottom:520px;}
#t2g_22{left:531px;bottom:520px;}
#t2h_22{left:538px;bottom:520px;}
#t2i_22{left:551px;bottom:520px;letter-spacing:0.03px;word-spacing:2.53px;}
#t2j_22{left:245px;bottom:501px;letter-spacing:0.06px;word-spacing:1.18px;}
#t2k_22{left:521px;bottom:501px;}
#t2l_22{left:529px;bottom:501px;letter-spacing:0.08px;word-spacing:1.15px;}
#t2m_22{left:245px;bottom:483px;letter-spacing:0.07px;word-spacing:1.33px;}
#t2n_22{left:390px;bottom:483px;}
#t2o_22{left:408px;bottom:483px;letter-spacing:-0.03px;word-spacing:1.5px;}
#t2p_22{left:245px;bottom:435px;letter-spacing:0.12px;}
#t2q_22{left:308px;bottom:435px;letter-spacing:0.14px;word-spacing:2.28px;}
#t2r_22{left:245px;bottom:407px;letter-spacing:0.12px;word-spacing:2.09px;}
#t2s_22{left:431px;bottom:407px;letter-spacing:0.1px;word-spacing:1.32px;}
#t2t_22{left:245px;bottom:388px;letter-spacing:0.09px;word-spacing:0.71px;}
#t2u_22{left:245px;bottom:370px;letter-spacing:0.07px;word-spacing:0.2px;}
#t2v_22{left:245px;bottom:352px;letter-spacing:0.07px;word-spacing:1.09px;}
#t2w_22{left:449px;bottom:352px;letter-spacing:0.1px;}
#t2x_22{left:476px;bottom:352px;letter-spacing:0.08px;word-spacing:1.4px;}
#t2y_22{left:245px;bottom:334px;letter-spacing:0.09px;word-spacing:1.71px;}
#t2z_22{left:245px;bottom:315px;letter-spacing:0.1px;word-spacing:1.02px;}
#t30_22{left:245px;bottom:297px;letter-spacing:0.06px;word-spacing:1.49px;}
#t31_22{left:447px;bottom:262px;}
#t32_22{left:456px;bottom:262px;}
#t33_22{left:462px;bottom:262px;}
#t34_22{left:471px;bottom:262px;}
#t35_22{left:478px;bottom:262px;}
#t36_22{left:491px;bottom:262px;letter-spacing:4.39px;}
#t37_22{left:517px;bottom:262px;letter-spacing:0.16px;}
#t38_22{left:543px;bottom:262px;}
#t39_22{left:558px;bottom:262px;}
#t3a_22{left:565px;bottom:262px;}
#t3b_22{left:245px;bottom:227px;letter-spacing:0.11px;}
#t3c_22{left:289px;bottom:227px;}
#t3d_22{left:308px;bottom:227px;letter-spacing:0.12px;}
#t3e_22{left:337px;bottom:227px;}
#t3f_22{left:349px;bottom:227px;letter-spacing:-0.02px;word-spacing:1.5px;}
#t3g_22{left:373px;bottom:184px;}
#t3h_22{left:390px;bottom:184px;}
#t3i_22{left:407px;bottom:205px;}
#t3j_22{left:425px;bottom:193px;}
#t3k_22{left:433px;bottom:193px;}
#t3l_22{left:439px;bottom:193px;}
#t3m_22{left:443px;bottom:193px;}
#t3n_22{left:465px;bottom:193px;}
#t3o_22{left:473px;bottom:193px;}
#t3p_22{left:479px;bottom:193px;}
#t3q_22{left:483px;bottom:193px;}
#t3r_22{left:425px;bottom:175px;}
#t3s_22{left:433px;bottom:174px;}
#t3t_22{left:439px;bottom:174px;}
#t3u_22{left:443px;bottom:174px;}
#t3v_22{left:465px;bottom:175px;}
#t3w_22{left:473px;bottom:174px;}
#t3x_22{left:479px;bottom:174px;}
#t3y_22{left:483px;bottom:174px;}
#t3z_22{left:497px;bottom:205px;}
#t40_22{left:526px;bottom:184px;letter-spacing:0.12px;}
#t41_22{left:566px;bottom:184px;}
#t42_22{left:577px;bottom:184px;}
#t43_22{left:593px;bottom:205px;}
#t44_22{left:612px;bottom:193px;}
#t45_22{left:617px;bottom:193px;}
#t46_22{left:612px;bottom:175px;}
#t47_22{left:617px;bottom:174px;}
#t48_22{left:632px;bottom:205px;}

.s0_22{font-size:15px;font-family:CMR10_109;color:#000;}
.s1_22{font-size:15px;font-family:CMSL10_10n;color:#000;}
.s2_22{font-size:22px;font-family:CMBX12_-i;color:#000;}
.s3_22{font-size:15px;font-family:CMR10_109;color:#00F;}
.s4_22{font-size:15px;font-family:CMBX10_-g;color:#000;}
.s5_22{font-size:15px;font-family:CMMI10_-u;color:#000;}
.s6_22{font-size:11px;font-family:CMR7_10h;color:#000;}
.s7_22{font-size:11px;font-family:CMMI7_--;color:#000;}
.s8_22{font-size:15px;font-family:CMTI10_10z;color:#000;}
.s9_22{font-size:15px;font-family:CMEX10_-q;color:#000;}
.sa_22{font-size:18px;font-family:CMBX12_-i;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts22" type="text/css" >

@font-face {
	font-family: CMBX10_-g;
	src: url("fonts/CMBX10_-g.woff") format("woff");
}

@font-face {
	font-family: CMBX12_-i;
	src: url("fonts/CMBX12_-i.woff") format("woff");
}

@font-face {
	font-family: CMEX10_-q;
	src: url("fonts/CMEX10_-q.woff") format("woff");
}

@font-face {
	font-family: CMMI10_-u;
	src: url("fonts/CMMI10_-u.woff") format("woff");
}

@font-face {
	font-family: CMMI7_--;
	src: url("fonts/CMMI7_--.woff") format("woff");
}

@font-face {
	font-family: CMR10_109;
	src: url("fonts/CMR10_109.woff") format("woff");
}

@font-face {
	font-family: CMR7_10h;
	src: url("fonts/CMR7_10h.woff") format("woff");
}

@font-face {
	font-family: CMSL10_10n;
	src: url("fonts/CMSL10_10n.woff") format("woff");
}

@font-face {
	font-family: CMTI10_10z;
	src: url("fonts/CMTI10_10z.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg22Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg22" style="-webkit-user-select: none;"><svg id="pdf22" width="935" height="1210" viewBox="0 0 935 1210" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0; isolation: isolate;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
</defs>
</svg></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_22" class="t s0_22">18 </span><span id="t2_22" class="t s1_22">CHAPTER 2. </span><span id="t3_22" class="t s1_22">IMAGE REGISTRATION </span>
<span id="t4_22" class="t s0_22" data-mappings='[[47,"ffi"]]'>We will soon see examples where more than two aﬃne matrices are combined </span>
<span id="t5_22" class="t s0_22">this way. </span>
<span id="t6_22" class="t s2_22">2.2 </span><span id="t7_22" class="t s2_22">Transformation models </span>
<span id="t8_22" class="t s0_22">In many situations, images will not be perfectly aligned as in Fig. </span><span id="t9_22" class="t s3_22">2.1</span><span id="ta_22" class="t s0_22">. This could </span>
<span id="tb_22" class="t s0_22">be because the patient has moved between the two acquisitions, for instance </span>
<span id="tc_22" class="t s0_22" data-mappings='[[42,"ff"],[63,"ff"]]'>because the scanning was performed on a diﬀerent day or on a diﬀerent scanner </span>
<span id="td_22" class="t s0_22">(e.g., MRI vs. CT scan). It could also be because of organ deformation, caused </span>
<span id="te_22" class="t s0_22">by breathing in a dynamic MRI, for instance, or because of tumor shrinkage or </span>
<span id="tf_22" class="t s0_22">patient weight loss during the course of a radiation therapy treatment. In such </span>
<span id="tg_22" class="t s0_22">situations, an additional geometrical transformation exists that a registration </span>
<span id="th_22" class="t s0_22">method should try to recover so that the images can still be compared to each </span>
<span id="ti_22" class="t s0_22">other. </span>
<span id="tj_22" class="t s0_22">Let </span><span id="tk_22" class="t s4_22">x </span><span id="tl_22" class="t s0_22">=(</span><span id="tm_22" class="t s5_22">x </span>
<span id="tn_22" class="t s6_22">1 </span>
<span id="to_22" class="t s5_22">,...,x </span>
<span id="tp_22" class="t s7_22">D </span>
<span id="tq_22" class="t s0_22">) </span>
<span id="tr_22" class="t s6_22">T </span>
<span id="ts_22" class="t s0_22">denote a spatial location (in world coordinates) in an </span>
<span id="tt_22" class="t s0_22">image that we will call the </span><span id="tu_22" class="t s8_22" data-mappings='[[0,"fi"]]'>ﬁxed </span><span id="tv_22" class="t s0_22">image in the remainder, where </span><span id="tw_22" class="t s5_22">D </span><span id="tx_22" class="t s0_22">= 2 in 2D </span>
<span id="ty_22" class="t s0_22">and </span><span id="tz_22" class="t s5_22">D </span><span id="t10_22" class="t s0_22">= 3 in 3D images. </span><span id="t11_22" class="t s0_22">Similarly, we will use </span><span id="t12_22" class="t s4_22">y </span><span id="t13_22" class="t s0_22">=(</span><span id="t14_22" class="t s5_22">y </span>
<span id="t15_22" class="t s6_22">1 </span>
<span id="t16_22" class="t s5_22">,...,y </span>
<span id="t17_22" class="t s7_22">D </span>
<span id="t18_22" class="t s0_22">) </span>
<span id="t19_22" class="t s6_22">T </span>
<span id="t1a_22" class="t s0_22">to denote </span>
<span id="t1b_22" class="t s0_22">spatial locations (again in world coordinates) in another image, which we will </span>
<span id="t1c_22" class="t s0_22">refer to as the </span><span id="t1d_22" class="t s8_22">moving </span><span id="t1e_22" class="t s0_22" data-mappings='[[22,"fi"]]'>image. Our task is to ﬁnd a transformation model </span>
<span id="t1f_22" class="t s4_22">y</span><span id="t1g_22" class="t s0_22">(</span><span id="t1h_22" class="t s4_22">x</span><span id="t1i_22" class="t s5_22">, </span><span id="t1j_22" class="t s4_22">w</span><span id="t1k_22" class="t s0_22">)= </span>
<span id="t1l_22" class="t s9_22"> </span>
<span id="t1m_22" class="t s9_22"> </span>
<span id="t1n_22" class="t s9_22"> </span>
<span id="t1o_22" class="t s5_22">y </span>
<span id="t1p_22" class="t s6_22">1 </span>
<span id="t1q_22" class="t s0_22">(</span><span id="t1r_22" class="t s4_22">x</span><span id="t1s_22" class="t s5_22">, </span><span id="t1t_22" class="t s4_22">w</span><span id="t1u_22" class="t s0_22">) </span>
<span id="t1v_22" class="t s0_22">. </span>
<span id="t1w_22" class="t s0_22">. </span>
<span id="t1x_22" class="t s0_22">. </span>
<span id="t1y_22" class="t s5_22">y </span>
<span id="t1z_22" class="t s7_22">D </span>
<span id="t20_22" class="t s0_22">(</span><span id="t21_22" class="t s4_22">x</span><span id="t22_22" class="t s5_22">, </span><span id="t23_22" class="t s4_22">w</span><span id="t24_22" class="t s0_22">) </span>
<span id="t25_22" class="t s9_22"> </span>
<span id="t26_22" class="t s9_22"> </span>
<span id="t27_22" class="t s9_22"> </span><span id="t28_22" class="t s0_22">(2.4) </span>
<span id="t29_22" class="t s0_22" data-mappings='[[22,"fi"]]'>so that points in the ﬁxed image are mapped to the corresponding anatomical </span>
<span id="t2a_22" class="t s0_22">locations in the moving image. </span><span id="t2b_22" class="t s0_22">Here </span><span id="t2c_22" class="t s5_22">y </span>
<span id="t2d_22" class="t s7_22">d </span>
<span id="t2e_22" class="t s0_22">(</span><span id="t2f_22" class="t s4_22">x</span><span id="t2g_22" class="t s5_22">, </span><span id="t2h_22" class="t s4_22">w</span><span id="t2i_22" class="t s0_22">) is a function that governs how </span>
<span id="t2j_22" class="t s0_22" data-mappings='[[14,"fi"]]'>points in the ﬁxed image move along the </span><span id="t2k_22" class="t s5_22">d</span><span id="t2l_22" class="t s0_22">-th direction in the moving image as </span>
<span id="t2m_22" class="t s0_22">the parameter vector </span><span id="t2n_22" class="t s4_22">w </span><span id="t2o_22" class="t s0_22">is varied. </span>
<span id="t2p_22" class="t sa_22">2.2.1 </span><span id="t2q_22" class="t sa_22">Linear transformations </span>
<span id="t2r_22" class="t s4_22" data-mappings='[[1,"ffi"]]'>Aﬃne transformation: </span><span id="t2s_22" class="t s0_22">In the most general form of linear transformations, </span>
<span id="t2t_22" class="t s0_22" data-mappings='[[31,"fi"]]'>lines that are straight in the ﬁxed image will still be straight when mapped into </span>
<span id="t2u_22" class="t s0_22">the moving image, but angles and areas/volumes are typically not preserved. An </span>
<span id="t2v_22" class="t s0_22">illustration is provided in Fig. </span><span id="t2w_22" class="t s3_22">2.2a</span><span id="t2x_22" class="t s0_22">. Such transformations are useful to roughly </span>
<span id="t2y_22" class="t s0_22" data-mappings='[[18,"ff"],[71,"fi"]]'>align images of diﬀerent individuals or time points (for instance as a ﬁrst step </span>
<span id="t2z_22" class="t s0_22" data-mappings='[[71,"ff"]]'>in a subsequent nonlinear registration algorithm), so that the major diﬀerences </span>
<span id="t30_22" class="t s0_22">in size and orientation are removed. The transformation model is governed by: </span>
<span id="t31_22" class="t s4_22">y</span><span id="t32_22" class="t s0_22">(</span><span id="t33_22" class="t s4_22">x</span><span id="t34_22" class="t s5_22">, </span><span id="t35_22" class="t s4_22">w</span><span id="t36_22" class="t s0_22">)= </span><span id="t37_22" class="t s4_22">Ax </span><span id="t38_22" class="t s0_22">+ </span><span id="t39_22" class="t s4_22">t</span><span id="t3a_22" class="t s5_22">, </span>
<span id="t3b_22" class="t s0_22">where </span><span id="t3c_22" class="t s4_22">A </span><span id="t3d_22" class="t s0_22">and </span><span id="t3e_22" class="t s4_22">t </span><span id="t3f_22" class="t s0_22">are given by </span>
<span id="t3g_22" class="t s4_22">A </span><span id="t3h_22" class="t s0_22">= </span>
<span id="t3i_22" class="t s9_22"> </span>
<span id="t3j_22" class="t s5_22">a </span>
<span id="t3k_22" class="t s6_22">1</span><span id="t3l_22" class="t s7_22">,</span><span id="t3m_22" class="t s6_22">1 </span>
<span id="t3n_22" class="t s5_22">a </span>
<span id="t3o_22" class="t s6_22">1</span><span id="t3p_22" class="t s7_22">,</span><span id="t3q_22" class="t s6_22">2 </span>
<span id="t3r_22" class="t s5_22">a </span>
<span id="t3s_22" class="t s6_22">2</span><span id="t3t_22" class="t s7_22">,</span><span id="t3u_22" class="t s6_22">1 </span>
<span id="t3v_22" class="t s5_22">a </span>
<span id="t3w_22" class="t s6_22">2</span><span id="t3x_22" class="t s7_22">,</span><span id="t3y_22" class="t s6_22">2 </span>
<span id="t3z_22" class="t s9_22"> </span>
<span id="t40_22" class="t s0_22">and </span><span id="t41_22" class="t s4_22">t </span><span id="t42_22" class="t s0_22">= </span>
<span id="t43_22" class="t s9_22"> </span>
<span id="t44_22" class="t s5_22">t </span>
<span id="t45_22" class="t s6_22">1 </span>
<span id="t46_22" class="t s5_22">t </span>
<span id="t47_22" class="t s6_22">2 </span>
<span id="t48_22" class="t s9_22"> </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
