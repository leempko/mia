<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p19" style="overflow: hidden; position: relative; background-color: white; width: 935px; height: 1210px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_19{left:163px;bottom:876px;letter-spacing:-0.24px;word-spacing:3.95px;}
#t2_19{left:163px;bottom:797px;letter-spacing:-0.07px;word-spacing:4.73px;}
#t3_19{left:163px;bottom:727px;letter-spacing:0.07px;word-spacing:0.11px;}
#t4_19{left:163px;bottom:708px;letter-spacing:0.08px;word-spacing:1.32px;}
#t5_19{left:163px;bottom:690px;letter-spacing:0.08px;word-spacing:1.81px;}
#t6_19{left:163px;bottom:672px;letter-spacing:0.08px;word-spacing:2px;}
#t7_19{left:163px;bottom:654px;letter-spacing:0.07px;word-spacing:2.69px;}
#t8_19{left:163px;bottom:635px;letter-spacing:0.06px;word-spacing:2.71px;}
#t9_19{left:560px;bottom:635px;letter-spacing:0.04px;word-spacing:2.97px;}
#ta_19{left:675px;bottom:635px;letter-spacing:0.1px;}
#tb_19{left:163px;bottom:617px;letter-spacing:0.14px;word-spacing:2.4px;}
#tc_19{left:163px;bottom:599px;letter-spacing:0.09px;word-spacing:1.15px;}
#td_19{left:346px;bottom:599px;letter-spacing:-0.06px;word-spacing:1.85px;}
#te_19{left:464px;bottom:599px;letter-spacing:0.08px;word-spacing:1.55px;}
#tf_19{left:163px;bottom:581px;letter-spacing:0.08px;word-spacing:1.29px;}
#tg_19{left:163px;bottom:523px;letter-spacing:-0.04px;}
#th_19{left:219px;bottom:523px;word-spacing:2.65px;}
#ti_19{left:163px;bottom:491px;letter-spacing:0.05px;word-spacing:2.03px;}
#tj_19{left:163px;bottom:472px;letter-spacing:0.05px;word-spacing:2.73px;}
#tk_19{left:163px;bottom:454px;letter-spacing:0.07px;word-spacing:1.08px;}
#tl_19{left:435px;bottom:454px;}
#tm_19{left:448px;bottom:454px;letter-spacing:4.39px;}
#tn_19{left:470px;bottom:454px;}
#to_19{left:479px;bottom:454px;}
#tp_19{left:486px;bottom:454px;letter-spacing:2.65px;}
#tq_19{left:501px;bottom:454px;}
#tr_19{left:508px;bottom:454px;letter-spacing:2.65px;}
#ts_19{left:523px;bottom:454px;}
#tt_19{left:530px;bottom:454px;}
#tu_19{left:536px;bottom:462px;}
#tv_19{left:546px;bottom:454px;letter-spacing:0.1px;word-spacing:1.08px;}
#tw_19{left:598px;bottom:454px;}
#tx_19{left:607px;bottom:454px;}
#ty_19{left:614px;bottom:454px;}
#tz_19{left:623px;bottom:454px;}
#t10_19{left:632px;bottom:454px;}
#t11_19{left:644px;bottom:454px;letter-spacing:0.12px;}
#t12_19{left:673px;bottom:454px;}
#t13_19{left:682px;bottom:454px;}
#t14_19{left:163px;bottom:436px;letter-spacing:0.03px;word-spacing:1.38px;}
#t15_19{left:163px;bottom:418px;letter-spacing:0.05px;word-spacing:1.88px;}
#t16_19{left:163px;bottom:399px;letter-spacing:0.08px;word-spacing:2.44px;}
#t17_19{left:163px;bottom:381px;letter-spacing:0.07px;word-spacing:0.36px;}
#t18_19{left:163px;bottom:363px;letter-spacing:0.08px;word-spacing:1.47px;}
#t19_19{left:566px;bottom:363px;letter-spacing:0.09px;}
#t1a_19{left:585px;bottom:363px;}
#t1b_19{left:186px;bottom:344px;letter-spacing:0.06px;word-spacing:1.94px;}
#t1c_19{left:163px;bottom:325px;letter-spacing:0.08px;word-spacing:3.35px;}
#t1d_19{left:163px;bottom:307px;letter-spacing:0.08px;word-spacing:2.35px;}
#t1e_19{left:163px;bottom:289px;letter-spacing:0.08px;word-spacing:2.7px;}
#t1f_19{left:163px;bottom:271px;letter-spacing:0.05px;word-spacing:4.03px;}
#t1g_19{left:314px;bottom:271px;}
#t1h_19{left:330px;bottom:271px;letter-spacing:5.82px;}
#t1i_19{left:353px;bottom:271px;}
#t1j_19{left:360px;bottom:270px;}
#t1k_19{left:367px;bottom:271px;letter-spacing:2.64px;}
#t1l_19{left:381px;bottom:270px;}
#t1m_19{left:388px;bottom:271px;letter-spacing:2.64px;}
#t1n_19{left:402px;bottom:270px;}
#t1o_19{left:409px;bottom:271px;}
#t1p_19{left:415px;bottom:278px;}
#t1q_19{left:430px;bottom:271px;letter-spacing:0.05px;word-spacing:2.22px;}
#t1r_19{left:163px;bottom:252px;letter-spacing:0.1px;word-spacing:1.89px;}
#t1s_19{left:295px;bottom:252px;}
#t1t_19{left:308px;bottom:252px;}
#t1u_19{left:318px;bottom:252px;}
#t1v_19{left:334px;bottom:252px;}
#t1w_19{left:346px;bottom:252px;}
#t1x_19{left:357px;bottom:252px;}
#t1y_19{left:372px;bottom:252px;}
#t1z_19{left:385px;bottom:252px;}
#t20_19{left:391px;bottom:252px;letter-spacing:0.1px;word-spacing:2.05px;}
#t21_19{left:446px;bottom:252px;}
#t22_19{left:454px;bottom:252px;}
#t23_19{left:466px;bottom:252px;letter-spacing:5.45px;}
#t24_19{left:491px;bottom:252px;letter-spacing:2.65px;}
#t25_19{left:530px;bottom:252px;}
#t26_19{left:541px;bottom:252px;}
#t27_19{left:556px;bottom:252px;letter-spacing:0.1px;word-spacing:1.89px;}
#t28_19{left:163px;bottom:234px;}
#t29_19{left:175px;bottom:234px;letter-spacing:4.4px;}
#t2a_19{left:199px;bottom:234px;letter-spacing:2.63px;}
#t2b_19{left:233px;bottom:234px;letter-spacing:0.09px;word-spacing:1.19px;}
#t2c_19{left:359px;bottom:234px;}
#t2d_19{left:371px;bottom:234px;}
#t2e_19{left:380px;bottom:234px;}
#t2f_19{left:395px;bottom:234px;}
#t2g_19{left:407px;bottom:234px;}
#t2h_19{left:416px;bottom:234px;}
#t2i_19{left:430px;bottom:234px;}
#t2j_19{left:442px;bottom:234px;}
#t2k_19{left:453px;bottom:234px;letter-spacing:0.06px;word-spacing:0.75px;}
#t2l_19{left:163px;bottom:216px;letter-spacing:0.15px;word-spacing:0.64px;}
#t2m_19{left:265px;bottom:216px;}
#t2n_19{left:279px;bottom:216px;letter-spacing:0.1px;word-spacing:0.75px;}
#t2o_19{left:341px;bottom:216px;}
#t2p_19{left:358px;bottom:216px;letter-spacing:0.1px;word-spacing:0.75px;}
#t2q_19{left:410px;bottom:216px;}
#t2r_19{left:424px;bottom:216px;letter-spacing:0.01px;word-spacing:0.91px;}
#t2s_19{left:481px;bottom:216px;}
#t2t_19{left:492px;bottom:216px;letter-spacing:0.05px;word-spacing:0.84px;}
#t2u_19{left:163px;bottom:198px;letter-spacing:0.08px;word-spacing:1.31px;}
#t2v_19{left:385px;bottom:177px;}
#t2w_19{left:398px;bottom:177px;}
#t2x_19{left:414px;bottom:177px;letter-spacing:0.16px;}
#t2y_19{left:441px;bottom:177px;}
#t2z_19{left:456px;bottom:177px;}
#t30_19{left:463px;bottom:177px;}
#t31_19{left:657px;bottom:177px;letter-spacing:0.09px;}
#t32_19{left:418px;bottom:138px;letter-spacing:0.11px;}

.s0_19{font-size:32px;font-family:CMBX12_-i;color:#000;}
.s1_19{font-size:38px;font-family:CMBX12_-i;color:#000;}
.s2_19{font-size:15px;font-family:CMR10_109;color:#000;}
.s3_19{font-size:15px;font-family:CMTI10_10z;color:#000;}
.s4_19{font-size:22px;font-family:CMBX12_-i;color:#000;}
.s5_19{font-size:15px;font-family:CMBX10_-g;color:#000;}
.s6_19{font-size:15px;font-family:CMMI10_-u;color:#000;}
.s7_19{font-size:11px;font-family:CMR7_10h;color:#000;}
.s8_19{font-size:15px;font-family:CMR10_109;color:#00F;}
.s9_19{font-size:15px;font-family:CMSY10_10p;color:#000;}
.sa_19{font-size:11px;font-family:CMMI7_--;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts19" type="text/css" >

@font-face {
	font-family: CMBX10_-g;
	src: url("fonts/CMBX10_-g.woff") format("woff");
}

@font-face {
	font-family: CMBX12_-i;
	src: url("fonts/CMBX12_-i.woff") format("woff");
}

@font-face {
	font-family: CMMI10_-u;
	src: url("fonts/CMMI10_-u.woff") format("woff");
}

@font-face {
	font-family: CMMI7_--;
	src: url("fonts/CMMI7_--.woff") format("woff");
}

@font-face {
	font-family: CMR10_109;
	src: url("fonts/CMR10_109.woff") format("woff");
}

@font-face {
	font-family: CMR7_10h;
	src: url("fonts/CMR7_10h.woff") format("woff");
}

@font-face {
	font-family: CMSY10_10p;
	src: url("fonts/CMSY10_10p.woff") format("woff");
}

@font-face {
	font-family: CMTI10_10z;
	src: url("fonts/CMTI10_10z.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg19Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg19" style="-webkit-user-select: none;"><svg id="pdf19" width="935" height="1210" viewBox="0 0 935 1210" style="width:935px; height:1210px; -moz-transform:scale(1); z-index: 0; isolation: isolate;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
</defs>
</svg></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_19" class="t s0_19">Chapter 2 </span>
<span id="t2_19" class="t s1_19">Image Registration </span>
<span id="t3_19" class="t s2_19">In many situations, the information contained in two or more images needs to be </span>
<span id="t4_19" class="t s2_19">combined. Examples of such situations include interpreting images of the same </span>
<span id="t5_19" class="t s2_19" data-mappings='[[22,"ff"],[52,"ff"]]'>patient acquired at diﬀerent time points, or with diﬀerent imaging modalities, </span>
<span id="t6_19" class="t s2_19">as well as comparing the anatomy or function between various subject groups </span>
<span id="t7_19" class="t s2_19" data-mappings='[[31,"ff"]]'>(e.g., to study how patients diﬀer from controls in a clinical research study). </span>
<span id="t8_19" class="t s2_19">In order for images to be used this way, they need to be </span><span id="t9_19" class="t s3_19">spatially aligned </span><span id="ta_19" class="t s2_19">so </span>
<span id="tb_19" class="t s2_19">that corresponding structures appear in corresponding locations. The process </span>
<span id="tc_19" class="t s2_19">of aligning images is called </span><span id="td_19" class="t s3_19">image registration</span><span id="te_19" class="t s2_19">. This chapter introduces some of </span>
<span id="tf_19" class="t s2_19">its basic concepts in a medical imaging context. </span>
<span id="tg_19" class="t s4_19">2.1 </span><span id="th_19" class="t s4_19">Coordinate systems </span>
<span id="ti_19" class="t s2_19">So far we have taken a rather cavalier attitude regarding the spatial locations </span>
<span id="tj_19" class="t s2_19">of voxels (pixels in 3D): for 3D images we have simply assumed that we can </span>
<span id="tk_19" class="t s2_19">index individual voxels by their location </span><span id="tl_19" class="t s5_19">x </span><span id="tm_19" class="t s2_19">=(</span><span id="tn_19" class="t s6_19">x </span>
<span id="to_19" class="t s7_19">1 </span>
<span id="tp_19" class="t s6_19">,x </span>
<span id="tq_19" class="t s7_19">2 </span>
<span id="tr_19" class="t s6_19">,x </span>
<span id="ts_19" class="t s7_19">3 </span>
<span id="tt_19" class="t s2_19">) </span>
<span id="tu_19" class="t s7_19">T </span>
<span id="tv_19" class="t s2_19">, where </span><span id="tw_19" class="t s6_19">x </span>
<span id="tx_19" class="t s7_19">1 </span>
<span id="ty_19" class="t s2_19">, </span><span id="tz_19" class="t s6_19">x </span>
<span id="t10_19" class="t s7_19">2 </span>
<span id="t11_19" class="t s2_19">and </span><span id="t12_19" class="t s6_19">x </span>
<span id="t13_19" class="t s7_19">3 </span>
<span id="t14_19" class="t s2_19">are integers. In reality, however, scanners can generate images with almost any </span>
<span id="t15_19" class="t s2_19">voxel size (spacing between the voxels in each of the three dimensions) and in </span>
<span id="t16_19" class="t s2_19">any orientation. In magnetic resonance imaging (MRI), for instance, it is not </span>
<span id="t17_19" class="t s2_19">uncommon to acquire multiple images when a patient is inside the scanner, each </span>
<span id="t18_19" class="t s2_19" data-mappings='[[2,"fi"]]'>deﬁned on its own image grid. An example is shown in Fig. </span><span id="t19_19" class="t s8_19">2.1</span><span id="t1a_19" class="t s2_19">. </span>
<span id="t1b_19" class="t s2_19" data-mappings='[[66,"ff"]]'>In order to relate multiple images to each other, we’ll need to diﬀerentiate </span>
<span id="t1c_19" class="t s2_19" data-mappings='[[48,"fi"]]'>the concept of “voxel coordinates” (which are deﬁned in integers units, and </span>
<span id="t1d_19" class="t s2_19">index individual voxels in a 3D image grid) from that of “world coordinates” </span>
<span id="t1e_19" class="t s2_19">(indicating the spatial positions of voxels in the real world, and measured in </span>
<span id="t1f_19" class="t s2_19" data-mappings='[[10,"fi"]]'>mm). Speciﬁcally, let </span><span id="t1g_19" class="t s5_19">v </span><span id="t1h_19" class="t s2_19">=(</span><span id="t1i_19" class="t s6_19">v </span>
<span id="t1j_19" class="t s7_19">1 </span>
<span id="t1k_19" class="t s6_19">,v </span>
<span id="t1l_19" class="t s7_19">2 </span>
<span id="t1m_19" class="t s6_19">,v </span>
<span id="t1n_19" class="t s7_19">3 </span>
<span id="t1o_19" class="t s2_19">) </span>
<span id="t1p_19" class="t s7_19">T </span>
<span id="t1q_19" class="t s2_19">denote the voxel coordinate of a voxel </span>
<span id="t1r_19" class="t s2_19">in an image of size </span><span id="t1s_19" class="t s6_19">N </span>
<span id="t1t_19" class="t s7_19">1 </span>
<span id="t1u_19" class="t s9_19">× </span><span id="t1v_19" class="t s6_19">N </span>
<span id="t1w_19" class="t s7_19">2 </span>
<span id="t1x_19" class="t s9_19">× </span><span id="t1y_19" class="t s6_19">N </span>
<span id="t1z_19" class="t s7_19">3 </span>
<span id="t20_19" class="t s2_19">, where </span><span id="t21_19" class="t s6_19">v </span>
<span id="t22_19" class="t sa_19">d </span>
<span id="t23_19" class="t s2_19">=0</span><span id="t24_19" class="t s6_19">,...N </span>
<span id="t25_19" class="t sa_19">d </span>
<span id="t26_19" class="t s9_19">- </span><span id="t27_19" class="t s2_19">1 for all dimensions </span>
<span id="t28_19" class="t s6_19">d </span><span id="t29_19" class="t s2_19">=1</span><span id="t2a_19" class="t s6_19">,..., </span><span id="t2b_19" class="t s2_19">3. In addition to a </span><span id="t2c_19" class="t s6_19">N </span>
<span id="t2d_19" class="t s7_19">1 </span>
<span id="t2e_19" class="t s9_19">× </span><span id="t2f_19" class="t s6_19">N </span>
<span id="t2g_19" class="t s7_19">2 </span>
<span id="t2h_19" class="t s9_19">× </span><span id="t2i_19" class="t s6_19">N </span>
<span id="t2j_19" class="t s7_19">3 </span>
<span id="t2k_19" class="t s2_19">array of intensities, the scanner will </span>
<span id="t2l_19" class="t s2_19">also encode a 3 </span><span id="t2m_19" class="t s9_19">× </span><span id="t2n_19" class="t s2_19">3 matrix </span><span id="t2o_19" class="t s5_19">A </span><span id="t2p_19" class="t s2_19">and a 3 </span><span id="t2q_19" class="t s9_19">× </span><span id="t2r_19" class="t s2_19">1 vector </span><span id="t2s_19" class="t s5_19">t </span><span id="t2t_19" class="t s2_19">to map voxel coordinates into </span>
<span id="t2u_19" class="t s2_19">world coordinates as follows: </span>
<span id="t2v_19" class="t s5_19">x </span><span id="t2w_19" class="t s2_19">= </span><span id="t2x_19" class="t s5_19">Av </span><span id="t2y_19" class="t s2_19">+ </span><span id="t2z_19" class="t s5_19">t</span><span id="t30_19" class="t s6_19">, </span><span id="t31_19" class="t s2_19">(2.1) </span>
<span id="t32_19" class="t s2_19">15 </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
