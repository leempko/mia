["Nonlinear Registration Koen Van Leemput Medical Image Analysis This work is licensed under CC BY 4.0 ","Spatial transformations “fixed” image “moving” image ","Spatial transformations “fixed” image “moving” image ","Spatial transformations “fixed” image “moving” image controls how points in the fixed image move along the -th direction in the moving image as the parameters are varied ","Spatial transformations rigid affine nonlinear ","Spatial transformations rigid affine nonlinear Examples of usage? ","Affine transformation ","Affine transformation controls how points in the fixed image move along the -th direction in the moving image as the parameters are varied ","Affine transformation ","Affine transformation ","Affine transformation ","Affine transformation ","Affine (linear ) transformation... ","...vs. nonlinear transformation with ","...vs. nonlinear transformation with “residual deformation” nonlinear basis functions ","fixed image interpolated moving image deformation moving image ","16 nonlinear basis functions ","direction 1 direction 2 deformation ","Focus on intra-modal registration Images have similar intensity characteristics sum over all voxels ","Focus on intra-modal registration Images have similar intensity characteristics sum over all voxels ","","Numerical optimization Find transformation parameters that minimize ","Gauss-Newton optimization Toy example: 1D and translation only ✔ transformation model: ✔ energy: with before optimization parameter to be optimized ","Gauss-Newton optimization Toy example: 1D and translation only ✔ transformation model: ✔ energy: with after optimization parameter to be optimized ","Gauss-Newton optimization Idea: for a small deviation around current estimate of : ✔ Energy: with Task: what is minimizing ? ","Gauss-Newton optimization Solution: standard linear regression! where with and Now update    : one basis function ","✔ Energy: with pixel 3 pixel 7 all pixels … + … + ... + … = initialization ","✔ Energy: with pixel 3 pixel 7 all pixels … + … + ... + … = after 1 iteration ","✔ Energy: with pixel 3 pixel 7 all pixels … + … + ... + … = after 2 iterations ","✔ Energy: with pixel 3 pixel 7 all pixels … + … + ... + … = after 3 iterations ","✔ Energy: with pixel 3 pixel 7 all pixels … + … + ... + … = after 4 iterations ","Gauss-Newton optimization Solution: standard linear regression! where with and Now update    : one basis function ","Gauss-Newton optimization Solution: standard linear regression! where with and one basis function Now update    : ","Gauss-Newton optimization In real situations, exactly the same idea but: ✔ spatial dimensions ✔ basis functions Solution: where and ","fixed image interpolated moving image deformation initialization ","fixed image interpolated moving image deformation after 10 iterations ","fixed image interpolated moving image deformation after 30 iterations ","fixed image interpolated moving image deformation after convergence ","fixed image interpolated moving image deformation after convergence What could possibly go wrong? ","Safety rails... We have assumed that is small ✔ What if it isn’t? Energy could go up instead of down ! ✔ Solution: Levenberg–Marquardt tunable "]