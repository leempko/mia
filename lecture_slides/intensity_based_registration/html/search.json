["Intensity-based Registration Koen Van Leemput Medical Image Analysis This work is licensed under CC BY 4.0 ","Recall landmark-based registration ✔ Manually annotate corresponding points in two images: ✔ Register the images by minimizing the distance between matching point pairs: fixed image moving image Spatial transformation model ","Spatial transformation models rigid affine nonlinear Spatial transformation : ✔ maps world positions in the fixed image to world positions in the moving image ✔ controlled by parameters ","Landmark-based registration fixed image fixed + moving Before registration moving image ","Landmark-based registration After registration fixed + interpolated moving fixed image interpolated moving image ","Landmark-based registration After registration fixed + interpolated moving fixed image interpolated moving image This lecture: define energy without landmarks ","Intra-modal registration Images have similar intensity characteristics Task: what’s a good energy function ? ","Intra-modal registration Images have similar intensity characteristics Task: what’s a good energy function ? ","Intra-modal registration Images have similar intensity characteristics sum over all voxels ","Intra-modal registration Images have similar intensity characteristics sum over all voxels ","","Intra-modal registration Same but images are scaled differently Task: what’s a good energy function ? ","Intra-modal registration Same but images are scaled differently Task: what’s a good energy function ? ","“Maximum” intensity histogram cumulative histogram max robust max ","Inter-modal registration Images have different intensity characteristics Task: what’s a good energy function ? ","Inter-modal registration Images have different intensity characteristics Task: what’s a good energy function ? ","Inter-modal registration Images have different intensity characteristics Easier task: what’s a good energy function now? ","Inter-modal registration Images have different intensity characteristics Easier task: what’s a good energy function now? ","Inter-modal registration Images have different intensity characteristics joint histogram intensity in fixed image intensity in moving image ","Inter-modal registration Images have different intensity characteristics joint histogram intensity in fixed image intensity in moving image ","Inter-modal registration Images have different intensity characteristics joint histogram intensity in fixed image intensity in moving image ","Inter-modal registration Images have different intensity characteristics joint histogram intensity in fixed image intensity in moving image ","A bit of information theory... Imagine that a coin is “rigged”: ✔ lands on heads with probability ✔ I toss it many times, and the result is 11010001011111011101000101111101101000101...1 ✔ The minimum number of bits required to store/communicate this result is (per toss): “heads” “tails” “entropy” ","Inter-modal registration Images have different intensity characteristics joint histogram where normalized histogram counts ","Inter-modal registration Images have different intensity characteristics joint histogram where normalized histogram counts ","","Diagnosing the problem A B Question: which image pair takes more bits to encode? ","Solution joint histogram histogram moving image histogram fixed image (negative “mutual information”) ","","Numerical optimization Find transformation parameters that minimize "]