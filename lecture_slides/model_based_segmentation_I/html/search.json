["Model-based Segmentation: Part I Koen Van Leemput Fall 2024 Medical Image Analysis This work is licensed under CC BY 4.0 ","Segmentation images segmentation - individual patients (diagnosis, treatment planning, follow-up) - group studies (drug trials, elucidating disease mechanisms) ","Exposing the “unseeable” today 8 months ago ","Measuring more consistently Quantifying lesions in multiple sclerosis (MS): - number (#) - volume (ml) ","Analyzing images faster segmentation MRI ","segmentation MRI ","Voxel-based segmentation Determine which anatomical structure each voxel belongs to: - think “LEGO bricks” - outer surfaces can easily be extracted if needed “voxel” ","Automated computational methods This and next lecture ","Automated computational methods This and next lecture ","MRI image The problem to be solved Label image : number of classes voxels : intensity in voxel ","One solution: generative modeling – Formulate a statistical model of how a medical image is formed – The model depends on some parameters – Appropriate values are assumed to be known for now... “labeling model” “imaging model” MRI image Label image ","Toy example voxels classes labeling model ","Toy example voxels classes imaging model ","Segmentation = inverse problem MRI image Label image ","MRI image Segmentation = inverse problem Label image The posterior distribution is given by Bayes rule: ","MRI image Segmentation = inverse problem Label image The posterior distribution is given by Bayes rule: labeling model ","MRI image Segmentation = inverse problem Label image The posterior distribution is given by Bayes rule: imaging model ","MRI image Segmentation = inverse problem Label image The posterior distribution is given by Bayes rule: (but not needed) ","Gaussian mixture model – Assign a label to each voxel independently – Probability of assigning label is “labeling model” “imaging model” MRI image Label image ","Gaussian mixture model voxels classes = . independence between voxels ","Gaussian mixture model – Draw the intensity in each voxel with label from a Gaussian distribution with mean and variance “labeling model” “imaging model” MRI image Label image ","Toy example voxels classes = . ","Gaussian mixture model labels ","Posterior probability distribution ","Maximum a posteriori segmentation white matter gray matter CSF ","Problem solved? Two-component Gaussian mixture model: tumor vs. “other” MR scan Posterior probability for tumor ","Gaussian mixture model “labeling model” “imaging model” MRI image Label image which part of the model needs fixing? ","Gaussian mixture model “labeling model” “imaging model” MRI image Label image ","Gaussian mixture model “labeling model” “imaging model” MRI image Label image ","Gaussian mixture model “labeling model” “imaging model” MRI image Label image ","Markov random field model “labeling model” “imaging model” MRI image Label image ","Markov random field model – Prior that prefers voxels with the same label to be spatially clustered – is a normalizing constant (not needed in practice) zero if labels are the same, one otherwise sum over all neighboring voxels strength of penalty ","Markov random field model – Slightly more general: – are the model parameters – Reduces to Gaussian mixture model prior for ! ","Toy example voxels classes ","Samples Different values for model parameters ","Why exactly this model? – Long-range statistical dependencies between voxels – Local computations (efficient!): all labels except the one of voxel i neighbors of voxel i ","Mean field approximation – In the Gaussian mixture model, the posterior was of the form – With the Markov random field model, the posterior no longer “factorizes” that way – For a 2-label model in a standard 256x256x128 MR scan, there are over 10 1000000 unique label images with each its own posterior probability! – Solution: approximate ","Mean field approximation – Approximate with something of the form – Find the voxel-wise distributions that minimize the difference between and – Quantify the difference between the two distributions using the “Kullback-Leibler divergence” ","Toy example voxels classes . ","Mean field approximation – Solution for one voxel : where ","Mean field approximation – Solution for one voxel : where Influenced by the result in neighboring voxels: spatial context!!!! ","Mean field approximation – Solution for one voxel : where Influenced by the result in neighboring voxels: spatial context!!!! – Need to iterate across all voxels ","Example Two-component Gaussian mixture model: tumor vs. “other” MR scan for tumor class ","Example Two-component Gaussian mixture model: tumor vs. “other” MR scan for tumor class ","Example Two-component Gaussian mixture model: tumor vs. “other” MR scan for tumor class "]