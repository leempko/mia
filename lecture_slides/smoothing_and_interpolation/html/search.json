["Smoothing and Interpolation Koen Van Leemput Medical Image Analysis This work is licensed under CC BY 4.0 ","Why care about smoothness? CT MRI mosaic CT/MRI Example: image registration ","Why care about smoothness? CT MRI mosaic CT/MRI Example: image registration ","Why care about smoothness? Example: image segmentation MR scan (7 Tesla) estimated “bias field” bias field corrected ","Why care about smoothness? Example: image interpolation ","Linear regression ✔ Let denote a spatial position in a -dimensional space ✔ Given measurements at locations , what is at a new location ? ","Linear regression ✔ Let denote a spatial position in a -dimensional space ✔ Given measurements at locations , what is at a new location ? tunable weights ","Linear regression ✔ Let denote a spatial position in a -dimensional space ✔ Given measurements at locations , what is at a new location ? tunable weights nonlinear basis functions ","Linear regression ✔ What are “suitable” values for the weights ? ✔ Minimize the energy ","Linear regression ✔ What are “suitable” values for the weights ? ✔ Minimize the energy Task: find that minimizes ","Linear regression ✔ What are “suitable” values for the weights ? ✔ Minimize the energy Task: find that minimizes ","Linear regression ✔ What are “suitable” values for the weights ? ✔ Minimize the energy ","Linear regression ✔ What are “suitable” values for the weights ? ✔ Minimize the energy ","Linear regression ✔ What are “suitable” values for the weights ? ✔ Minimize the energy ","Smoothing Let’s concentrate on one-dimensional (1D) “images”: ✔ Functions of the form where the location is a scalar ✔ Measurement points are defined on a regular grid: “Denoising”: ✔ The measurements are noisy observations ✔ Recover the underlying signal at the locations ","Smoothing ✔ We aim to recover from ✔ Since and : with ","Example M=7 basis functions ","Example M=28 basis functions ","Example M=28 basis functions What happens when M=N? ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when Consider the case and ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when Consider the case and ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when ","Consider the case and Discuss with your neighbor Task 1: what is ? Task 2: what are and ? Can you explain (e.g., draw) what’s happening? Task 3: same as task 2 but when When M=N, no smoothing is applied! ","Interpolation Meet the B-spline family: ✔ ✔ where “order” ","Use basis functions: ✔ will pass exactly through at the integer locations Interpolation Order 0: “nearest neighbor” interpolation (almost) ","Use basis functions: ✔ will pass exactly through at the integer locations Interpolation Order 1: “linear” interpolation ","Use basis functions: ✔ will pass exactly through at the integer locations Interpolation Order 3: “cubic” interpolation ","Going to higher dimensions Re-arrange pixels in 2D images of size into 1D signals of length ✔ Vectorize the image to be smoothed or interpolated ✔ Also vectorize each of the 2D basis functions Solve the resulting 1D problem as before ","Separable basis functions Create 2D basis functions from two sets of 1D basis functions ✔ Kronecker product: , where ✔ Column in contains a vectorized version of ","Separable basis functions = x ","Exploiting separability ✔ When , we can compute faster as follows: where ✔ As a result, we can also compute as: where ","Exploiting separability ✔ When , we can compute faster as follows: where ✔ As a result, we can also compute as: where Example: naively interpolating a 256x256 image (M = 256*256 = 65,536 basis functions in 2D!) Storing takes 32 GB, vs. 1MB to store both and Inverting is almost 10 million times slower than inverting both and ","Smoothing in 2D smoothing in the row-direction smoothing in the column-direction ","Interpolation in 2D “nearest neighbor” “linear” “cubic” "]