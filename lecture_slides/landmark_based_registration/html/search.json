["Landmark-based Registration Koen Van Leemput Medical Image Analysis This work is licensed under CC BY 4.0 ","Image registration Combine information contained in different scans Images need to be spatially aligned! ? ? ","Image registration ! ! Combine information contained in different scans Images need to be spatially aligned! ","Example: PET/MR Before registration... ","Example: PET/MR … after registration ","Example: CT/MR Before registration… ","Example: CT/MR … after registration ","Example: longitudinal scans Patient with multiple sclerosis (MS) two months ago ","Example: longitudinal scans Patient with multiple sclerosis (MS) today ","Example: population studies average of 152 individuals International Consortium for Brain Mapping ","Example: population studies average of 152 individuals International Consortium for Brain Mapping ","Example: population studies average of 152 individuals International Consortium for Brain Mapping ","Coordinate systems For each image, there are two coordinate systems: ✔ Voxel coordinates (integer indices) ✔ World coordinates (in mm) Conversion: ","Coordinate systems voxel indices world positions Conversion: ","World coordinates = convention Important to know which convention is used! R ight – A nterior – S uperior (RAS) L eft – P osterior – S uperior (LPS) ","Homogeneous coordinates Vectors are augmented with a 1 at the end ✔ Idea: Rewrite , i.e, as: ✔ Benefit: map voxel indices using only matrix multiplications ","voxel indices world positions voxel indices ","Spatial transformations “fixed” image “moving” image ","Spatial transformations “fixed” image “moving” image ","Spatial transformations “fixed” image “moving” image controls how points in the fixed image move along the -th direction in the moving image as the parameters are varied ","Spatial transformations rigid affine nonlinear ","Spatial transformations rigid affine nonlinear Examples of usage? ","Affine transformation ","Affine transformation controls how points in the fixed image move along the -th direction in the moving image as the parameters are varied ","Affine transformation ","Affine transformation ","Affine transformation ","Affine transformation ","Affine transformation ","Rigid transformation and ","Rigid transformation Task: why do and impose a rotation? ","Rigid transformation Task: why do and impose a rotation? ","Rigid transformation Task: why do and impose a rotation? ? ","Rigid transformation Task: why do and impose a rotation? ? ","Landmark-based registration ✔ Manually annotate corresponding points in two images: ✔ Register the images by minimizing the distance between matching point pairs: fixed image moving image ","Landmark-based registration Applied to affine registration: Task 1: if , what is ? Hint: remember that Task 2: in the general case, what are and ? ","Landmark-based registration Applied to affine registration: Task 1: if , what is ? Hint: remember that Task 2: in the general case, what are and ? ","Landmark-based registration Applied to affine registration: Task 1: if , what is ? Hint: remember that Task 2: in the general case, what are and ? ","Landmark-based registration Applied to affine registration: Task 1: if , what is ? Hint: remember that Task 2: in the general case, what are and ? ","Landmark-based registration Applied to affine registration: where Task 1: if , what is ? Hint: remember that Task 2: in the general case, what are and ? ","Landmark-based registration fixed image fixed + moving moving image Before registration ","Landmark-based registration After registration fixed image fixed + moving moving image ","Landmark-based registration Applied to rigid registration: ✔ Constraints and make the math much more complicated! ✔ Solution: and with (“flip” a column of if ) where and "]